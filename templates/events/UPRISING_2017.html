<div id="event-header">
  <div class="event-overview">
    <div class="event-image">
      <img src="./resources/updates/{{::data.id}}/logo.png" />
    </div>
    <div class="event-info">
      <div ng-show="$ctrl.item.dates.end > $ctrl.currentDate" class="event-active">
        <h2 class="event-time">Event ends on {{$ctrl.item.dates.end | date:'MMM d'}} local time</h2>
        <h3>Be sure to get everything you want by {{$ctrl.item.dates.end - 86400000 | date:'MMM d'}} to be safe!</h3>
      </div>
      <div ng-show="$ctrl.item.dates.end < $ctrl.currentDate" class="event-ended">
        <h2 class="event-time">Event ended on {{$ctrl.item.dates.end | date:'MMM d yyyy'}}  local time</h2>
      </div>
    </div>
  </div>

  <!-- OPTIONS DON'T CURRENTLY WORK -->
  <div class="options">
    <div class="btn btn-default" ng-show="hero.filtering" uib-tooltip="Clear Filters" ng-click="hero.clearFilters()" tooltip-append-to-body="true">Clear Filters</div>
    <div class="btn-group" uib-dropdown is-open="showDropdown" auto-close="outsideClick">
      <div class="btn btn-default" uib-dropdown-toggle uib-tooltip="Filter Items" tooltip-append-to-body="true">
        Filter <span class="caret"></span>
      </div>
      <ul class="dropdown-menu dropdown-menu-right" uib-dropdown-menu>
        <li>
          <div>
            <label for="filterSelected">Selected <input id="filterSelected" type="checkbox" ng-change="hero.filters.unselected = false;hero.updateFilters()" ng-model="hero.filters.selected" ng-disabled="hero.totals.selected == 0 && !hero.filtering"></label>
          </div>
        </li>
        <li>
          <div>
            <label for="filterUnselected">UnSelected <input id="filterUnselected" type="checkbox" ng-change="hero.filters.selected = false;hero.updateFilters()" ng-model="hero.filters.unselected" ng-disabled="hero.totals.selected == 0 && !hero.filtering"></label>
          </div>
        </li>
        </li>
        <li class="divider"></li>
        <li>
          <div>
            <label for="achievementf">Achievement/Special <input id="achievementf" type="checkbox" ng-change="hero.updateFilters()" ng-model="hero.filters.achievement"></label>
          </div>
        </li>
        <li class="divider" ng-show="::hero.hasGroups()"></li>
        <li ng-repeat="(group, val) in ::hero.groups track by $index">
          <div>
            <label for="{{::group}}">{{::group}} <input id="{{::group}}" type="checkbox" ng-change="hero.updateFilters()" ng-model="hero.filters.groups[group]"></label>
          </div>
        </li>
        <li class="divider" ng-show="::hero.hasEvents()"></li>
        <li ng-repeat="event in ::$ctrl.events track by $index" ng-hide="::!hero.events[event.id]">
          <div>
            <label for="{{::event.id}}">{{::event.name}} <input id="{{::event.id}}" type="checkbox" ng-change="hero.updateFilters()" ng-model="hero.filters.events[event.id]"></label>
          </div>
        </li>
      </ul>
    </div>
    <div class="toggle-grid btn btn-default" uib-tooltip="Toggle Grid View" ng-click="hero.toggleGrid()" tooltip-append-to-body="true">Toggle Grid</div>
    <div class="select-all btn btn-default" uib-tooltip="Select all items" ng-click="hero.selectAll()" tooltip-append-to-body="true">Select All</div>
    <div class="select-all btn btn-default" uib-tooltip="Unselect all items" ng-click="hero.unSelectAll()" tooltip-append-to-body="true">Unselect All</div>
  </div>
  <!-- END OF OPTIONS -->

  <div class="event-progress">
    <!--<div class="event-progress-bar" style="width:{{event.totals.percentage}}%; background-color: {{event.colors.primary}}; border-top-color: {{event.colors.highlight}}"></div>-->
    <div class="event-progress-bar" style="width:20%; background-color: #7c3cba; border-top-color: #8945c0"></div>
    <span><!--{{event.totals.selected}} / {{event.totals.total}}-->X / Y Unlocks</span>
  </div>
  <span class="currentfilter" ng-show="event.filtering">Currently Filtering: {{event.currentFilters}}</span>
</div>


<legendary-skins></legendary-skins>


<div class="event-items">
  <div id="epicskins" class="section">
    <div class="section-header">
      <h2>Epic Skins <small>750</small></h2>
    </div>
    <event-item ng-repeat="item in ::data.items.skinsEpic track by $index" type="skins"></event-item>
  </div>

  <div id="emotes" class="section">
    <div class="section-header">
      <h2>Emotes <small>750</small></h2>
    </div>
    <event-item ng-repeat="item in ::data.items.emotes track by $index" type="emotes"></event-item>
  </div>

  <div id="intros" class="section">
    <div class="section-header">
      <h2>Highlight Intros <small>750</small></h2>
    </div>
    <event-item ng-repeat="item in ::data.items.intros track by $index" type="intros"></event-item>
  </div>

  <div id="icons" class="section">
    <div class="section-header">
      <h2>Player Icons</h2>
    </div>
    <event-item ng-repeat="item in ::data.items.icons track by $index" type="icons" noHero="true"></event-item>
  </div>

  <div id="poses" class="section">
    <div class="section-header">
      <h2>Victory Poses <small>225</small></h2>
    </div>
    <event-item ng-repeat="item in ::data.items.poses track by $index" type="poses"></event-item>
  </div>

  <div id="sprays" class="section">
    <div class="section-header">
      <h2>Sprays <small>75</small></h2>
    </div>

    <span
      class="item {{::item.quality}}"
      achievement="{{::item.achievement || 'false'}}"
      ng-mouseenter="showPreview(spray, 'spray')"
      ng-mouseleave="hidePreview()"
      ng-repeat="spray in ::data.items.sprays track by $index">
      <input type="checkbox" id="{{'spray' + $index}}" ng-model="checked[spray.hero][spray][spray.id]" ng-change="onSelect()">
      <label for="{{spray + $index}}">
        <h3 class="{{::spray.quality}}">{{::spray.heroName || spray.name}}</h3>
        <h4 ng-show="spray.heroName">{{::spray.name}}</h4>
      </label>
    </span>
  </div>

  <div id="voicelines" class="section">
    <div class="section-header">
      <h2>Voice Lines <small>75</small></h2>
    </div>
    <event-item ng-repeat="item in ::data.items.voicelines track by $index" type="voicelines"></event-item>
  </div>
</div>
